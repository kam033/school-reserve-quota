# نظام تعدد المستخدمين - دليل الاستخدام

## نظرة عامة
تم تطوير نظام إدارة الحصص الاحتياطية ليدعم تعدد المستخدمين، حيث يمكن لأكثر من شخص استخدام النظام في الوقت نفسه، وكل مستخدم يمتلك صلاحياته الخاصة حسب دوره.

## الأدوار والصلاحيات

### 1. مدير النظام (System Admin)
**الصلاحيات الكاملة:**
- ✅ إضافة مستخدمين جدد (مدراء مدارس أو مدراء نظام آخرين)
- ✅ حذف المستخدمين من النظام
- ✅ عرض جميع المستخدمين المسجلين
- ✅ الوصول إلى بيانات جميع المدارس
- ✅ رفع جداول XML لأي مدرسة
- ✅ تسجيل الغيابات والتقارير لجميع المدارس

**بيانات الدخول الافتراضية:**
- اسم المستخدم: `admin`
- كلمة المرور: `admin123`

### 2. مدير المدرسة (School Director)
**صلاحيات محدودة ضمن مدرسته فقط:**
- ✅ رفع جدول XML الخاص بمدرسته فقط
- ✅ عرض جداول المعلمين في مدرسته
- ✅ تسجيل غيابات المعلمين في مدرسته
- ✅ عرض التقارير والإحصائيات الخاصة بمدرسته
- ✅ استخدام جميع ميزات النظام ضمن نطاق مدرسته
- ❌ لا يمكنه رؤية أو الوصول إلى بيانات المدارس الأخرى
- ❌ لا يمكنه إضافة أو حذف المستخدمين

## كيفية إضافة مستخدم جديد

### الخطوات (لمدير النظام فقط):

1. **تسجيل الدخول كمدير نظام**
   - استخدم بيانات الدخول الافتراضية أو حسابك كمدير نظام

2. **الوصول إلى صفحة إضافة مستخدم**
   - من الصفحة الرئيسية، اضغط على بطاقة "إضافة مستخدم جديد"
   - أو اضغط على زر "إضافة مستخدم جديد" من القائمة

3. **ملء بيانات المستخدم الجديد**
   - **اسم المستخدم**: اسم فريد للدخول (مثل: `director_school1`)
   - **كلمة المرور**: كلمة مرور قوية
   - **الاسم الكامل**: الاسم الكامل للمستخدم (مثل: محمد أحمد)
   - **الصلاحية**: اختر من القائمة:
     - مدير النظام
     - مدير المدرسة
   - **اسم المدرسة** (يظهر فقط عند اختيار "مدير المدرسة"): أدخل اسم المدرسة (مثل: مدرسة النور الابتدائية)

4. **إضافة المستخدم**
   - اضغط على زر "إضافة المستخدم"
   - سيظهر إشعار بنجاح الإضافة
   - سيتم إنشاء معرف فريد للمدرسة تلقائياً

### ملاحظات مهمة:
- ⚠️ اسم المستخدم يجب أن يكون فريداً - لا يمكن تكرار نفس اسم المستخدم
- ⚠️ اسم المدرسة **إلزامي** لمدراء المدارس
- ✅ سيتم ربط جميع البيانات التي يرفعها المدير بمدرسته تلقائياً
- ✅ لن يتمكن المدير من رؤية بيانات المدارس الأخرى

## إدارة المستخدمين

### عرض المستخدمين الحاليين:
1. من الصفحة الرئيسية، اضغط على بطاقة "إدارة المستخدمين"
2. ستظهر قائمة بجميع المستخدمين المسجلين في النظام
3. كل مستخدم يعرض:
   - الاسم الكامل
   - الصلاحية (مدير نظام / مدير مدرسة)
   - اسم المستخدم
   - اسم المدرسة (للمدراء)

### حذف مستخدم:
1. من صفحة "إدارة المستخدمين"، اضغط على زر "حذف" بجانب المستخدم
2. أكد الحذف في نافذة التأكيد
3. سيتم حذف المستخدم نهائياً من النظام

### قيود الحذف:
- ❌ لا يمكن حذف مدير النظام الأساسي (admin)
- ❌ لا يمكن حذف حسابك الشخصي
- ⚠️ حذف مستخدم لا يحذف بيانات مدرسته (الجداول والغيابات)

## عزل البيانات بين المدارس

### كيف يعمل النظام:
1. **عند رفع جدول XML**: يتم ربط الجدول بمعرف المدرسة (schoolId) الخاص بالمستخدم الذي رفعه
2. **عند عرض الجداول**: كل مدير مدرسة يرى فقط الجداول الخاصة بمدرسته
3. **عند تسجيل الغياب**: يتم ربط الغياب بمدرسة المعلم تلقائياً
4. **عند عرض التقارير**: تظهر فقط البيانات الخاصة بمدرسة المدير

### مدير النظام:
- يرى **جميع** الجداول من **جميع** المدارس
- يمكنه رفع جداول لأي مدرسة
- يمكنه تسجيل غيابات لأي مدرسة

## سيناريو الاستخدام

### مثال عملي:

1. **مدير النظام يضيف مدراء المدارس:**
   ```
   المستخدم: director_school1
   الاسم: أحمد محمد
   الصلاحية: مدير المدرسة
   المدرسة: مدرسة النور الابتدائية
   
   المستخدم: director_school2
   الاسم: فاطمة علي
   الصلاحية: مدير المدرسة
   المدرسة: مدرسة الأمل الثانوية
   ```

2. **كل مدير يسجل دخوله ويرفع جدول مدرسته:**
   - أحمد يرفع جدول مدرسة النور
   - فاطمة ترفع جدول مدرسة الأمل
   - كل مدير يرى فقط جدول مدرسته

3. **استخدام النظام بشكل مستقل:**
   - أحمد يسجل غيابات معلمي مدرسة النور
   - فاطمة تسجل غيابات معلمي مدرسة الأمل
   - البيانات معزولة تماماً - لا تداخل بينها

4. **مدير النظام يراقب الجميع:**
   - يمكنه رؤية جميع الجداول والغيابات
   - يمكنه تصدير تقارير شاملة
   - يمكنه إضافة مدارس جديدة

## الأمان

### حماية البيانات:
- ✅ كل مستخدم لديه حساب منفصل
- ✅ كلمات المرور محفوظة في النظام
- ✅ البيانات معزولة بين المدارس
- ✅ صلاحيات واضحة ومحددة

### نصائح الأمان:
- 🔐 استخدم كلمات مرور قوية
- 🔐 غيّر كلمة مرور المدير الافتراضية
- 🔐 لا تشارك بيانات الدخول
- 🔐 احذف المستخدمين غير النشطين

## الدعم الفني

في حالة وجود أي مشاكل أو استفسارات:
- راجع دليل المستخدم (USER_GUIDE.md)
- راجع ملف المشروع (PRD.md)
- تواصل مع فريق التطوير

---

**تم التطوير والتحديث:** ديسمبر 2024
**الإصدار:** 2.0 - نظام متعدد المستخدمين
