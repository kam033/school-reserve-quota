# دليل استخدام نظام إدارة الحصص الاحتياطية

## 📋 نظرة عامة
نظام ذكي متكامل لإدارة الجداول المدرسية والحصص الاحتياطية يعتمد على ملفات XML المستخرجة من برنامج aSc Timetables.

---

## 🚀 البدء السريع

### 1️⃣ تسجيل الدخول
- اضغط على زر **"تسجيل الدخول"** في الصفحة الرئيسية
- بيانات الدخول التجريبية:
  - اسم المستخدم: `admin`
  - كلمة المرور: `admin123`

### 2️⃣ رفع ملف XML
1. اضغط على **"تحميل الجدول"**
2. اختر ملف XML من جهازك (مُصدّر من aSc Timetables)
3. سيقوم النظام تلقائياً بـ:
   - تحويل الملف إلى ترميز UTF-8 بدون BOM
   - إزالة أي رموز غير مفهومة
   - استخراج بيانات المعلمين والحصص
   - عرض جدول تفصيلي لجميع المعلمين

### 3️⃣ اعتماد البيانات ⚠️ **خطوة مهمة جداً**
بعد رفع الملف بنجاح:
1. راجع البيانات المعروضة في الجدول
2. تأكد من صحة أسماء المعلمين والمواد
3. **اضغط على زر "اعتماد البيانات"** لتفعيل البيانات في النظام

> 🔴 **تنبيه مهم:** جميع الأزرار الأخرى (جداول المعلمين، التقرير الإحصائي، الغياب، إلخ) **لن تعمل** إلا بعد اعتماد البيانات!

---

## 📌 كيفية عمل الأزرار

### ✅ الأزرار التي تعمل بدون اعتماد:
- **تسجيل الدخول**: متاح دائماً
- **تحميل الجدول**: يعمل بعد تسجيل الدخول
- **إضافة مستخدم جديد**: للمشرفين فقط

### ⚠️ الأزرار التي تحتاج إلى اعتماد:
هذه الأزرار **لن تعرض البيانات** إلا بعد اعتماد الجدول:
- **عرض الجدول الكامل**: يعرض جميع البيانات من الملف
- **جداول المعلمين**: يعرض جدول كل معلم بشكل تفصيلي
- **غياب المعلمين**: لتسجيل الغياب اليومي
- **تقرير إحصائي**: يعرض الإحصاءات والتقارير

> إذا قمت بالضغط على أي زر من هذه الأزرار قبل الاعتماد، ستظهر رسالة:  
> **"⚠️ لا يوجد جدول معتمد - يرجى رفع ملف XML واعتماده أولاً"**

---

## 🎯 خطوات استخدام كل قسم

### 📂 تحميل الجدول (XML Upload)
**الغرض:** رفع ملف XML من aSc Timetables

**الخطوات:**
1. افتح صفحة "تحميل الجدول"
2. اختر ملف XML
3. انتظر معالجة الملف (تلقائياً)
4. راجع جدول المعلمين المعروض
5. **اضغط "اعتماد البيانات"** ✓

**ملاحظات:**
- النظام يحول الملف تلقائياً لـ UTF-8
- لا تحتاج لتعديل الملف يدوياً في Notepad++
- الأخطاء والتحذيرات تظهر تلقائياً

---

### 🧾 جداول المعلمين
**الغرض:** عرض الجدول الأسبوعي لكل معلم

**الخطوات:**
1. اختر اسم المعلم من القائمة
2. شاهد الجدول الأسبوعي الملون
3. استخدم الأسهم للتنقل بين المعلمين

**المميزات:**
- ألوان مختلفة لكل مادة
- عرض الأيام والحصص بشكل واضح
- عدد الحصص الأسبوعية لكل معلم
- معلومات تفصيلية عند التحويم (Hover)

---

### 📅 غياب المعلمين
**الغرض:** تسجيل غياب المعلمين وتعيين البدلاء

**الخطوات:**
1. اختر التاريخ واليوم
2. اختر المعلم الغائب
3. حدد الحصص (يمكن اختيار أكثر من حصة)
4. اختر المعلم البديل (اختياري)
   - النظام يعرض المعلمين المتاحين فقط
5. اضغط "تسجيل الغياب"

**ملاحظات:**
- المعلمون المشغولون لا يظهرون في قائمة البدلاء
- يمكن عرض جميع الغيابات لليوم الحالي

---

### 📊 التقرير الإحصائي
**الغرض:** عرض إحصاءات شاملة عن النظام

**يعرض:**
- عدد المعلمين الكلي
- عدد المواد الدراسية
- عدد الحصص
- الغيابات اليوم
- نسبة التغطية
- الغيابات الأخيرة

---

### 📈 الرسم البياني الذكي ⭐ **ميزة جديدة**
**الغرض:** تحليل الأحمال التدريسية واختيار المعلم البديل الأمثل باستخدام الذكاء الاصطناعي

**الأقسام الثلاثة:**

#### 1️⃣ التحليل البياني
**الخطوات:**
1. اختر المعلم (أو "جميع المعلمين" للمقارنة)
2. اختر المادة (اختياري)
3. اختر نوع الرسم (أعمدة أو خطي)
4. شاهد الرسم البياني التفاعلي

**المميزات:**
- عرض عدد الحصص لكل يوم (الأحد - الخميس)
- مقارنة أحمال المعلمين
- ألوان مميزة لكل مادة دراسية
- رسم بياني بالأعمدة أو الخطوط

**الاستخدام:** 
معرفة توزيع الحصص الأسبوعية وتحديد الأيام المزدحمة لكل معلم

---

#### 2️⃣ اختيار البديل الذكي 🤖
**الغرض:** اقتراح أفضل معلم بديل تلقائياً باستخدام نظام النقاط

**كيف يعمل النظام:**

**نظام التقييم (Scoring System):**
- ✅ **متاح في الحصة = +5 نقاط** (الأهم)
- ✅ **نفس المادة = +3 نقاط**
- ✅ **نفس الصف = +2 نقاط**
- ✅ **نسبة احتياطي منخفضة = +1 نقطة**
- ⚠️ **لديه حصة قبل أو بعد = -3 نقاط**
- ⚠️ **نسبة احتياطي مرتفعة = -2 نقطة**

**الخطوات:**
1. اختر اليوم (الأحد، الإثنين، إلخ)
2. اختر رقم الحصة (1-8)
3. اختر نوع الفلتر:
   - **جميع المعلمين**: يعرض جميع المعلمين المتاحين
   - **نفس المادة**: يعرض فقط معلمي نفس المادة
   - **نفس الصف**: يعرض فقط معلمي نفس الصف
4. إذا اخترت "نفس المادة" → حدد المادة
5. إذا اخترت "نفس الصف" → حدد الصف
6. سيظهر **قائمة ذكية مرتبة** بأفضل المعلمين البدلاء

**ما يعرضه النظام:**
- 🥇 **الأنسب**: المعلم الحاصل على أعلى نقاط (مُبرز بحدود زرقاء)
- النقاط الإجمالية لكل معلم
- **أسباب التقييم** لكل معلم:
  - "✅ متاح في هذه الحصة (+5)"
  - "✅ نفس المادة (+3)"
  - "⚠️ لديه حصة قبل أو بعد مباشرة (-3)"
  - "✅ نسبة احتياطي منخفضة (15%) (+1)"

**مثال عملي:**
```
اليوم: الأحد
الحصة: 3
الفلتر: نفس المادة
المادة: الرياضيات

النتيجة:
🥇 الأنسب: أحمد محمد - 9 نقاط
   ✅ متاح في هذه الحصة (+5)
   ✅ نفس المادة (+3)
   ✅ نسبة احتياطي منخفضة (12%) (+1)

2. سارة علي - 6 نقاط
   ✅ متاح في هذه الحصة (+5)
   ✅ نفس المادة (+3)
   ⚠️ نسبة احتياطي مرتفعة (45%) (-2)
```

**ملاحظات:**
- النظام **يستبعد تلقائياً** المعلمين المشغولين
- يظهر **حتى 10 مرشحين** مرتبين حسب الأفضلية
- إذا لم يوجد معلمين متاحين، سيعرض رسالة تحذير

---

#### 3️⃣ عدالة التوزيع 📊
**الغرض:** ضمان توزيع عادل لحصص الاحتياطي بين جميع المعلمين

**ما يعرضه:**
- قائمة بجميع المعلمين
- عدد حصص الاحتياطي لكل معلم
- نسبة مئوية للحمل
- شريط تقدم ملون حسب النسبة

**نظام الألوان:**
- 🟢 **أقل من 20%** = قليل - يمكن إضافة المزيد
- 🟡 **بين 20% و40%** = متوسط - توزيع جيد
- 🔴 **أكثر من 40%** = مرتفع - يفضل تخفيف العبء

**الاستخدام:**
- متابعة العدالة في التوزيع
- تحديد المعلمين الذين لديهم حمل زائد
- تحديد المعلمين الذين يمكن إضافة المزيد لهم

**مثال:**
```
أحمد محمد - الرياضيات
15 حصة | 12%
🟢 قليل - يمكن إضافة المزيد

سارة علي - العلوم  
55 حصة | 45%
🔴 مرتفع - يفضل تخفيف العبء
```

---

### 📋 عرض الجدول الكامل
**الغرض:** عرض جميع البيانات المستخرجة من XML

**الأقسام:**
1. **الجدول**: جميع الحصص الأسبوعية
2. **المعلمون**: قائمة بجميع المعلمين
3. **الفصول**: قائمة بجميع الفصول
4. **المواد**: قائمة بجميع المواد
5. **الغرف**: قائمة بالغرف الدراسية

---

## ❓ الأسئلة الشائعة

### لماذا الأزرار لا تعمل؟
**السبب:** لم يتم اعتماد الجدول بعد رفع ملف XML.

**الحل:**
1. اذهب إلى "تحميل الجدول"
2. اضغط على زر "اعتماد البيانات" بجوار الجدول المرفوع
3. سيتحول الشعار من "غير معتمد" إلى "معتمد"
4. الآن جميع الأزرار ستعمل!

### كيف أعرف إذا كان الجدول معتمداً؟
- في صفحة "تحميل الجدول"، سترى شارة **"✓ معتمد"** باللون الأخضر
- في شريط التنقل العلوي، سترى **"✓ جدول معتمد"**
- إذا لم يكن معتمداً، ستظهر **"⚠ جدول غير معتمد"**

### هل يمكن اعتماد أكثر من جدول؟
نعم، يمكنك رفع عدة جداول واعتماد كل واحد منها. النظام سيعرض البيانات من جميع الجداول المعتمدة.

### ماذا لو رفعت ملفاً خاطئاً؟
يمكنك حذف الجدول من صفحة "تحميل الجدول" بالضغط على أيقونة سلة المهملات 🗑️

### هل أحتاج لتعديل ملف XML قبل رفعه؟
لا، النظام يقوم بجميع التحويلات تلقائياً:
- تحويل الترميز إلى UTF-8
- إزالة الرموز الغريبة
- تصحيح الأخطاء الشائعة

### كيف يختار النظام أفضل معلم بديل؟
النظام يستخدم **خوارزمية ذكية** تحسب نقاط لكل معلم بناءً على:
1. **التوافر**: هل المعلم فاضٍ في الحصة؟ (+5 نقاط)
2. **التخصص**: هل يدرّس نفس المادة؟ (+3 نقاط)
3. **الصف**: هل يدرّس نفس الصف؟ (+2 نقاط)
4. **الراحة**: هل لديه حصة قبل أو بعد؟ (-3 نقاط)
5. **العدالة**: هل نسبة احتياطيه منخفضة؟ (+1 نقطة)

المعلم الحاصل على أعلى نقاط يظهر أولاً كـ **"الأنسب"**.

### ما فائدة قسم "عدالة التوزيع"؟
يساعدك على:
- ضمان عدم تحميل معلم واحد أكثر من اللازم
- تحديد المعلمين الذين يمكن إضافة المزيد من الحصص لهم
- متابعة العدالة في توزيع حصص الاحتياطي
- اتخاذ قرارات مبنية على بيانات واقعية

---

## 🎓 نصائح للاستخدام الأمثل

### 1. دائماً اعتمد البيانات بعد الرفع
لا تنسى الضغط على "اعتماد البيانات" - هذه الخطوة **ضرورية**!

### 2. راجع الجدول قبل الاعتماد
تأكد من صحة:
- أسماء المعلمين
- المواد الدراسية
- عدد الحصص لكل معلم

### 3. استخدم "دليل التحضير"
في صفحة "تحميل الجدول"، يوجد تبويب "دليل التحضير" يشرح كيفية تحضير ملف XML من aSc Timetables.

### 4. استخدم الرسم البياني الذكي لاختيار البدلاء
بدلاً من البحث اليدوي، استخدم قسم "اختيار البديل الذكي" للحصول على توصيات ذكية مبنية على البيانات.

### 5. راقب عدالة التوزيع
تحقق من قسم "عدالة التوزيع" بانتظام للتأكد من توزيع حصص الاحتياطي بشكل عادل بين المعلمين.

### 6. سجّل الغياب يومياً
استخدم صفحة "غياب المعلمين" كل صباح لتسجيل الغيابات وتعيين البدلاء.

### 7. راقب التقرير الإحصائي
تحقق من التقرير الإحصائي بانتظام لمتابعة:
- معدل الغياب
- نسبة التغطية
- توزيع الحصص

---

## 🔒 الصلاحيات

### مدير النظام (Admin)
- إضافة مستخدمين جدد
- رفع واعتماد الجداول
- الوصول لجميع الميزات

### مدير المدرسة (Director)
- رفع واعتماد الجداول
- عرض جميع الجداول
- تسجيل الغياب
- عرض التقارير

### معلم (Teacher)
- عرض جدوله الشخصي فقط

---

## 📞 الدعم الفني

إذا واجهت أي مشكلة:
1. تأكد من اعتماد الجدول أولاً
2. راجع هذا الدليل
3. تحقق من رسائل الأخطاء في الشاشة
4. جرب حذف الجدول وإعادة رفعه

---

## ✨ الخلاصة

**لكي تعمل جميع الأزرار:**
1. ✅ سجّل الدخول
2. ✅ ارفع ملف XML
3. ✅ **اعتمد البيانات** ← **أهم خطوة!**
4. ✅ استخدم جميع المميزات

**تذكر:** الاعتماد ضروري لحماية النظام من استخدام بيانات خاطئة!

---

**نتمنى لك تجربة استخدام ممتعة! 🎉**
