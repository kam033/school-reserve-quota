# ูุธุงู ุนุฒู ุงูุจูุงูุงุช (Data Isolation System)

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทุจูู ูุธุงู ุนุฒู ุงูุจูุงูุงุช ุงููุงูู ูู ุงูุชุทุจูู ูุถูุงู ุงูุฎุตูุตูุฉ ูุงูุฃูุงู ุจูู ุงููุฏุงุฑุณ ุงููุฎุชููุฉ. ูุนูู ุงููุธุงู ุนูู ูุตู ุงูุจูุงูุงุช ุจูุงุกู ุนูู ุฏูุฑ ุงููุณุชุฎุฏู ููุนุฑู ูุฏุฑุณุชู (schoolId).

## ุงูููุงุนุฏ ุงูุฃุณุงุณูุฉ

### 1. **ูุฏูุฑ ุงููุฏุฑุณุฉ (Director)**
- **ุงููุตูู**: ููููู ููุท ุฑุคูุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุฏุฑุณุชู
- **ุงูุฌุฏุงูู**: ูุฑู ููุท ุงูุฌุฏูู ุงูุฐู ูุงู ุจุฑูุนู
- **ุงููุนูููู**: ูุฑู ููุท ูุนููู ูุฏุฑุณุชู
- **ุงูุบูุงุจุงุช**: ูุฑู ููุฏูุฑ ููุท ุบูุงุจุงุช ูุนููู ูุฏุฑุณุชู
- **ุงูุฅุญุตุงุฆูุงุช**: ุชูุญุณุจ ููุท ูู ุจูุงูุงุช ูุฏุฑุณุชู

### 2. **ูุฏูุฑ ุงููุธุงู (Admin)**
- **ุงููุตูู ุงููุงูู**: ููููู ุฑุคูุฉ ุฌููุน ุงูุจูุงูุงุช ูู ูู ุงููุฏุงุฑุณ
- **ุงูุฅุดุฑุงู**: ูุณุชุทูุน ูุชุงุจุนุฉ ุฌููุน ุงูุฌุฏุงูู ูุงููุนูููู ูุงูุญุตุต
- **ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู**: ูู ุงููุญูุฏ ุงูุฐู ููููู ุฅุถุงูุฉ ุฃู ุญุฐู ุงููุณุชุฎุฏููู
- **ุงููุคุดุฑุงุช**: ูุฑู ุงุณู ุงููุฏุฑุณุฉ ุจุฌุงูุจ ูู ุนูุตุฑ ูู ุงูุจูุงูุงุช

## ุงููุธุงุฆู ุงููุฑูุฒูุฉ

ุชู ุฅูุดุงุก ุฏูุงู ูุฑูุฒูุฉ ูู `src/lib/utils.ts` ูููุชุฑุฉ ุงูุจูุงูุงุช:

### `filterSchedulesByUser(schedules, currentUser)`
ุชููู ุจููุชุฑุฉ ุงูุฌุฏุงูู ุงููุฏุฑุณูุฉ ุจูุงุกู ุนูู ุฏูุฑ ุงููุณุชุฎุฏู:
```typescript
// ูุฏูุฑ ุงููุฏุฑุณุฉ: ูุฑู ููุท ุฌุฏุงูู ูุฏุฑุณุชู
// ูุฏูุฑ ุงููุธุงู: ูุฑู ุฌููุน ุงูุฌุฏุงูู
```

### `filterAbsencesByUser(absences, currentUser)`
ุชููู ุจููุชุฑุฉ ุณุฌูุงุช ุงูุบูุงุจ ุจูุงุกู ุนูู ุฏูุฑ ุงููุณุชุฎุฏู:
```typescript
// ูุฏูุฑ ุงููุฏุฑุณุฉ: ูุฑู ููุท ุบูุงุจุงุช ูุนููู ูุฏุฑุณุชู
// ูุฏูุฑ ุงููุธุงู: ูุฑู ุฌููุน ุงูุบูุงุจุงุช
```

### `getSchoolDisplayName(scheduleData, allUsers)`
ุชููู ุจุฅุฑุฌุงุน ุงุณู ุงููุฏุฑุณุฉ ุงููุนุฑูุถ ุจูุงุกู ุนูู ุจูุงูุงุช ุงูุฌุฏูู:
```typescript
// ุชุจุญุซ ุนู ุงุณู ุงููุฏุฑุณุฉ ูู ุจูุงูุงุช ุงููุณุชุฎุฏู
// ุฅุฐุง ูู ููู ููุฌูุฏุ ุชุนุฑุถ ูุนุฑู ูุฎุชุตุฑ
```

## ุงูุตูุญุงุช ุงููุญููุฉ

### 1. **ุตูุญุฉ ุฑูุน ุงูุฌุฏุงูู (XMLUploadPage)**
- ุนูุฏ ุฑูุน ุฌุฏูู ุฌุฏูุฏุ ูุชู ุฑุจุทู ุชููุงุฆูุงู ุจูุนุฑู ูุฏุฑุณุฉ ุงููุณุชุฎุฏู ุงูุญุงูู
- `schoolId = currentUser?.schoolId || 'school-default'`

### 2. **ุตูุญุฉ ุฌุฏุงูู ุงููุนูููู (TeacherSchedulesPage)**
- ุชุนุฑุถ ููุท ุงููุนูููู ูู ุงูุฌุฏุงูู ุงููุตูุงุฉ
- ูุฏูุฑ ุงููุธุงู ูุฑู ุงุณู ุงููุฏุฑุณุฉ ุจุฌุงูุจ ูู ูุนูู ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ
- ูุฏูุฑ ุงููุธุงู ูุฑู badge ุจุฌุงูุจ ุงุณู ุงููุนูู ุงููุญุฏุฏ

### 3. **ุตูุญุฉ ุงูุบูุงุจ (AbsencePage)**
- ุชุนุฑุถ ููุท ูุนููู ุงููุฏุฑุณุฉ ุงููุฑุชุจุทุฉ ุจุงููุณุชุฎุฏู
- ุนูุฏ ุชุณุฌูู ุบูุงุจุ ูุชู ุญูุธ `schoolId` ูุน ุงูุณุฌู
- ุชูุตูู ูุงุฆูุฉ ุงูุบูุงุจุงุช ุญุณุจ ุงููุฏุฑุณุฉ

### 4. **ุตูุญุฉ ุงูุฅุญุตุงุฆูุงุช (StatsPage)**
- ุชูุญุณุจ ุงูุฅุญุตุงุฆูุงุช ููุท ูู ุจูุงูุงุช ุงููุฏุฑุณุฉ ุงููุตูุงุฉ
- ุนุฏุฏ ุงููุนููููุ ุงูุญุตุตุ ุงูุบูุงุจุงุช ุฌููุนูุง ุฎุงุตุฉ ุจุงููุฏุฑุณุฉ

### 5. **ุตูุญุฉ ุนุฑุถ ุงูุฌุฏูู (ScheduleViewPage)**
- ุชุนุฑุถ ููุท ุชูุงุตูู ุงูุฌุฏูู ุงูุฎุงุต ุจุงููุฏุฑุณุฉ
- ูุฏูุฑ ุงููุธุงู ูุฑู badge ุจุงุณู ุงููุฏุฑุณุฉ ูู ุงูุนููุงู

### 6. **ุตูุญุฉ ุงูุชุญูููุงุช ุงูุฐููุฉ (SmartAnalyticsPage)**
- ุฌููุน ุงูุชุญูููุงุช ูุงูุฑุณูู ุงูุจูุงููุฉ ูุตูุงุฉ ุญุณุจ ุงููุฏุฑุณุฉ
- ุงูุชุฑุงุญุงุช ุงููุนูููู ุงูุจุฏูููู ูู ููุณ ุงููุฏุฑุณุฉ ููุท

## ุขููุฉ ุงูุนูู

### ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
```typescript
const user = await login(username, password)
// ูุชู ุชุฎุฒูู: user.role ู user.schoolId
```

### ุนูุฏ ุฑูุน ุฌุฏูู
```typescript
const scheduleData: ScheduleData = {
  ...parsedData,
  schoolId: currentUser?.schoolId || 'school-default',
  uploadDate: new Date().toISOString(),
  approved: true
}
```

### ุนูุฏ ุฌูุจ ุงูุจูุงูุงุช
```typescript
// ูู ูู ุตูุญุฉุ ูุชู ุงุณุชุฎุฏุงู:
const approvedSchedules = useMemo(() => {
  const approved = schedules.filter((s) => s.approved)
  return filterSchedulesByUser(approved, currentUser)
}, [schedules, currentUser])
```

## ูุคุดุฑุงุช ุงููุฏุฑุณุฉ ููุฏูุฑ ุงููุธุงู

ุนูุฏูุง ูููู ุงููุณุชุฎุฏู ุงูุญุงูู ูู ูุฏูุฑ ุงููุธุงู (`role === 'admin'`)ุ ูุชู ุนุฑุถ:

1. **Badge** ุจุฌุงูุจ ุงุณู ูู ูุนูู ููุถุญ ุงุณู ูุฏุฑุณุชู
2. **Badge** ูู ุงูุนููุงู ุงูุฑุฆูุณู ููุตูุญุฉ ููุถุญ ุงููุฏุฑุณุฉ ุงููุนุฑูุถุฉ
3. ุฌููุน ุงููุคุดุฑุงุช ุชุณุชุฎุฏู ุงูุชูุณูู: `๐ซ ุงุณู ุงููุฏุฑุณุฉ`

## ุงูุฃูุงู ูุงูุฎุตูุตูุฉ

โ **ูุง ุชู ุชุทุจููู:**
- ุนุฒู ูุงูู ููุจูุงูุงุช ุจูู ุงููุฏุงุฑุณ
- ูุง ูููู ููุฏูุฑ ูุฏุฑุณุฉ ุฑุคูุฉ ุจูุงูุงุช ูุฏุฑุณุฉ ุฃุฎุฑู
- ุฌููุน ุงูุนูููุงุช (ุนุฑุถุ ุฅุถุงูุฉุ ุชุนุฏููุ ุญุฐู) ูุญููุฉ ุจุงูููุชุฑุฉ
- ุฑุจุท ุชููุงุฆู ููุจูุงูุงุช ุงูุฌุฏูุฏุฉ ุจูุนุฑู ุงููุฏุฑุณุฉ

โ **ุงูุตูุงุญูุงุช:**
- ูุฏูุฑ ุงููุธุงู: ูุตูู ูุงูู ูุฅุดุฑุงู ุนูู ูู ุดูุก
- ูุฏูุฑ ุงููุฏุฑุณุฉ: ูุตูู ูุงูู ูุจูุงูุงุช ูุฏุฑุณุชู ููุท
- ุงููุนูู: ูุตูู ูุญุฏูุฏ (ุฅู ููุฌุฏ ูู ุงููุณุชูุจู)

## ูุซุงู ุนููู

### ุณููุงุฑูู 1: ูุฏูุฑ ูุฏุฑุณุฉ ูุณุฌู ุฏุฎูู
```
1. ูุณุฌู ุงูุฏุฎูู ุจุญุณุงุจ: director1 (schoolId: "school-abc")
2. ูุฑูุน ุฌุฏูู XML โ ููุญูุธ ูุน schoolId: "school-abc"
3. ููุชุญ ุตูุญุฉ ุงููุนูููู โ ูุฑู ููุท ูุนููู ูุฏุฑุณุชู
4. ูุณุฌู ุบูุงุจ โ ููุญูุธ ูุน schoolId: "school-abc"
5. ููุชุญ ุงูุฅุญุตุงุฆูุงุช โ ุชูุญุณุจ ูู ุจูุงูุงุช ูุฏุฑุณุชู ููุท
```

### ุณููุงุฑูู 2: ูุฏูุฑ ุงููุธุงู ูุณุฌู ุฏุฎูู
```
1. ูุณุฌู ุงูุฏุฎูู ุจุญุณุงุจ: admin (role: "admin")
2. ููุชุญ ุตูุญุฉ ุงููุนูููู โ ูุฑู ุฌููุน ุงููุนูููู ูู ูู ุงููุฏุงุฑุณ
3. ูู ูุนูู ูุธูุฑ ูุนู badge ุจุงุณู ูุฏุฑุณุชู
4. ููุชุญ ุงูุฅุญุตุงุฆูุงุช โ ุชูุญุณุจ ูู ุฌููุน ุงููุฏุงุฑุณ
5. ููููู ูุฑุงูุจุฉ ููุชุงุจุนุฉ ูู ุดูุก ูู ุงููุธุงู
```

## ุงูุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ

ูููู ุชุทููุฑ ุงููุธุงู ุจุฅุถุงูุฉ:
- ๐ ุชูุฑูุฑ ููุงุฑูุฉ ุจูู ุงููุฏุงุฑุณ (ููุฏูุฑ ุงููุธุงู ููุท)
- ๐ ุชุดููุฑ ุฅุถุงูู ููุจูุงูุงุช ุงูุญุณุงุณุฉ
- ๐ ุณุฌู ุชุฏููู (Audit Log) ูุฌููุน ุงูุนูููุงุช
- ๐ ุฅุดุนุงุฑุงุช ููุฏูุฑ ุงููุธุงู ุนูุฏ ุฑูุน ุฌุฏุงูู ุฌุฏูุฏุฉ
- ๐ ููุญุฉ ุชุญูู ูุฑูุฒูุฉ ููุฏูุฑ ุงููุธุงู

---

**ุชู ุงูุชุทุจูู ุจุชุงุฑูุฎ:** 2024
**ุงูุฅุตุฏุงุฑ:** 1.0
**ุงูุญุงูุฉ:** โ ููุนูู ููุนูู ุจุดูู ูุงูู
